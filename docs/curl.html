<!DOCTYPE html>
<html>
  <head>
    <title>Package 'curl' reference manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <!-- styling for math and syntax -->
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/katex.min.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/R.css">
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/prism.css">

    <!-- for (future) customizations -->
    <script src="https://r-universe.dev/static/manual.js"></script>
    <link rel="stylesheet" type="text/css" href="https://r-universe.dev/static/manual.css?nocache=1">

  </head>

  <body class="macintosh">
    <h1 class="manual-title">Package 'curl'</h1>
    <table class="description-table">
      <tr>
<th>Title:</th>
<td class="description-title">A Modern and Flexible Web Client for R</td>
</tr>
      <tr>
<th>Description:</th>
<td class="description-description">The curl() and curl_download() functions provide highly
    configurable drop-in replacements for base url() and download.file() with
    better performance, support for encryption (https, ftps), gzip compression,
    authentication, and other 'libcurl' goodies. The core of the package implements a
    framework for performing fully customized requests where data can be processed
    either in memory, on disk, or streaming via the callback or connection
    interfaces. Some knowledge of 'libcurl' is recommended; for a more-user-friendly
    web client see the 'httr' package which builds on this package with http
    specific tools and logic.</td>
</tr>
      <tr>
<th>Authors:</th>
<td class="description-author"><span>Jeroen Ooms [aut, cre] <a href="https://orcid.org/0000-0002-4035-0289" target="_blank"><img style="height:1em" src="https://cran.r-project.org/web/orcid.svg"></a>,
  Hadley Wickham [ctb],
  RStudio [cph]</span></td>
</tr>
      <tr>
<th>Maintainer:</th>
<td class="description-maintainer">Jeroen Ooms &lt;jeroen@berkeley.edu&gt;</td>
</tr>
      <tr>
<th>License:</th>
<td class="description-license">MIT + file LICENSE</td>
</tr>
      <tr>
<th>Version:</th>
<td class="description-version">5.0.9000</td>
</tr>
      <tr>
<th>Built:</th>
<td class="description-date">2023-05-24 16:45:18 UTC</td>
</tr>
      <tr>
<th>Source:</th>
<td class="description-source">https://github.com/jeroen/curl</td>
</tr>
    </table>

    <a href="#help-index" style="color:black;"><h2 id="help-index">Help Index</h2></a>
    <ul id="help-index-list">
<li class="help-index-item"><a href="#curl">Curl connection interface</a></li>
<li class="help-index-item"><a href="#curl_download">Download file to disk</a></li>
<li class="help-index-item"><a href="#curl_echo">Echo Service</a></li>
<li class="help-index-item"><a href="#curl_escape">URL encoding</a></li>
<li class="help-index-item"><a href="#curl_fetch">Fetch the contents of a URL</a></li>
<li class="help-index-item"><a href="#curl_options">List curl version and options.</a></li>
<li class="help-index-item"><a href="#curl_upload">Upload a File</a></li>
<li class="help-index-item"><a href="#file_writer">Lazy File Writer</a></li>
<li class="help-index-item"><a href="#handle">Create and configure a curl handle</a></li>
<li class="help-index-item"><a href="#handle_cookies">Extract cookies from a handle</a></li>
<li class="help-index-item"><a href="#ie_proxy">Internet Explorer proxy settings</a></li>
<li class="help-index-item"><a href="#multi">Async Concurrent Requests</a></li>
<li class="help-index-item"><a href="#multi_download">Advanced download interface</a></li>
<li class="help-index-item"><a href="#multipart">POST files or data</a></li>
<li class="help-index-item"><a href="#nslookup">Lookup a hostname</a></li>
<li class="help-index-item"><a href="#parse_date">Parse date/time</a></li>
<li class="help-index-item"><a href="#parse_headers">Parse response headers</a></li>
<li class="help-index-item"><a href="#send_mail">Send email</a></li>
</ul>

    <hr>
    <div class="manual-pages-content">
<div class="container manual-page" id="curl">

<a href="#curl" class="help-page-title"><h2 id="curl">Curl connection interface</h2></a>

<h3>Description</h3>

<p>Drop-in replacement for base <code><a href="https://r-universe.dev/manuals/base.html#connections">url</a></code> that supports https, ftps,
gzip, deflate, etc. Default behavior is identical to <code><a href="https://r-universe.dev/manuals/base.html#connections">url</a></code>, but
request can be fully configured by passing a custom <code><a href="#handle">handle</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">curl<span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">"http://httpbin.org/get"</span><span class="token punctuation">,</span> open <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> handle <span class="token operator">=</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="curl_:_url">url</code></td>
<td>
<p>character string. See examples.</p>
</td>
</tr>
<tr>
<td><code id="curl_:_open">open</code></td>
<td>
<p>character string. How to open the connection if it should be opened
initially. Currently only "r" and "rb" are supported.</p>
</td>
</tr>
<tr>
<td><code id="curl_:_handle">handle</code></td>
<td>
<p>a curl handle object</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As of version 2.3 curl connections support <code>open(con, blocking = FALSE)</code>.
In this case <code>readBin</code> and <code>readLines</code> will return immediately with data
that is available without waiting. For such non-blocking connections the caller
needs to call <code><a href="https://r-universe.dev/manuals/base.html#connections">isIncomplete</a></code> to check if the download has completed
yet.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Not run: </span>
con <span class="token operator">&lt;-</span> curl<span class="token punctuation">(</span><span class="token string">"https://httpbin.org/get"</span><span class="token punctuation">)</span>
readLines<span class="token punctuation">(</span>con<span class="token punctuation">)</span>

<span class="token comment"># Auto-opened connections can be recycled</span>
open<span class="token punctuation">(</span>con<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span>
bin <span class="token operator">&lt;-</span> readBin<span class="token punctuation">(</span>con<span class="token punctuation">,</span> raw<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">999</span><span class="token punctuation">)</span>
close<span class="token punctuation">(</span>con<span class="token punctuation">)</span>
rawToChar<span class="token punctuation">(</span>bin<span class="token punctuation">)</span>

<span class="token comment"># HTTP error</span>
curl<span class="token punctuation">(</span><span class="token string">"https://httpbin.org/status/418"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>

<span class="token comment"># Follow redirects</span>
readLines<span class="token punctuation">(</span>curl<span class="token punctuation">(</span><span class="token string">"https://httpbin.org/redirect/3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Error after redirect</span>
curl<span class="token punctuation">(</span><span class="token string">"https://httpbin.org/redirect-to?url=http://httpbin.org/status/418"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>

<span class="token comment"># Auto decompress Accept-Encoding: gzip / deflate (rfc2616 #14.3)</span>
readLines<span class="token punctuation">(</span>curl<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/gzip"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
readLines<span class="token punctuation">(</span>curl<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/deflate"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Binary support</span>
buf <span class="token operator">&lt;-</span> readBin<span class="token punctuation">(</span>curl<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/bytes/98765"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> raw<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1e5</span><span class="token punctuation">)</span>
length<span class="token punctuation">(</span>buf<span class="token punctuation">)</span>

<span class="token comment"># Read file from disk</span>
test <span class="token operator">&lt;-</span> paste0<span class="token punctuation">(</span><span class="token string">"file://"</span><span class="token punctuation">,</span> system.file<span class="token punctuation">(</span><span class="token string">"DESCRIPTION"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
readLines<span class="token punctuation">(</span>curl<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Other protocols</span>
read.csv<span class="token punctuation">(</span>curl<span class="token punctuation">(</span><span class="token string">"ftp://cran.r-project.org/pub/R/CRAN_mirrors.csv"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
readLines<span class="token punctuation">(</span>curl<span class="token punctuation">(</span><span class="token string">"ftps://test.rebex.net:990/readme.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
readLines<span class="token punctuation">(</span>curl<span class="token punctuation">(</span><span class="token string">"gopher://quux.org/1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Streaming data</span>
con <span class="token operator">&lt;-</span> curl<span class="token punctuation">(</span><span class="token string">"http://jeroen.github.io/data/diamonds.json"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>length<span class="token punctuation">(</span>x <span class="token operator">&lt;-</span> readLines<span class="token punctuation">(</span>con<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  print<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment"># Stream large dataset over https with gzip</span>
library<span class="token punctuation">(</span>jsonlite<span class="token punctuation">)</span>
con <span class="token operator">&lt;-</span> gzcon<span class="token punctuation">(</span>curl<span class="token punctuation">(</span><span class="token string">"https://jeroen.github.io/data/nycflights13.json.gz"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
nycflights <span class="token operator">&lt;-</span> stream_in<span class="token punctuation">(</span>con<span class="token punctuation">)</span>

<span class="token comment">## End(Not run)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="curl_download">

<a href="#curl_download" class="help-page-title"><h2 id="curl_download">Download file to disk</h2></a>

<h3>Description</h3>

<p>Libcurl implementation of <code>C_download</code> (the "internal" download method)
with added support for https, ftps, gzip, etc. Default behavior is identical
to <code><a href="https://r-universe.dev/manuals/utils.html#download.file">download.file</a></code>, but request can be fully configured by passing
a custom <code><a href="#handle">handle</a></code>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">curl_download<span class="token punctuation">(</span>url<span class="token punctuation">,</span> destfile<span class="token punctuation">,</span> quiet <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token string">"wb"</span><span class="token punctuation">,</span> handle <span class="token operator">=</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="curl_download_:_url">url</code></td>
<td>
<p>A character string naming the URL of a resource to be downloaded.</p>
</td>
</tr>
<tr>
<td><code id="curl_download_:_destfile">destfile</code></td>
<td>
<p>A character string with the name where the downloaded file
is saved. Tilde-expansion is performed.</p>
</td>
</tr>
<tr>
<td><code id="curl_download_:_quiet">quiet</code></td>
<td>
<p>If <code>TRUE</code>, suppress status messages (if any), and the
progress bar.</p>
</td>
</tr>
<tr>
<td><code id="curl_download_:_mode">mode</code></td>
<td>
<p>A character string specifying the mode with which to write the file.
Useful values are <code>"w"</code>, <code>"wb"</code> (binary), <code>"a"</code> (append)
and <code>"ab"</code>.</p>
</td>
</tr>
<tr>
<td><code id="curl_download_:_handle">handle</code></td>
<td>
<p>a curl handle object</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main difference between <code>curl_download</code> and <code>curl_fetch_disk</code>
is that <code>curl_download</code> checks the http status code before starting the
download, and raises an error when status is non-successful. The behavior of
<code>curl_fetch_disk</code> on the other hand is to proceed as normal and write
the error page to disk in case of a non success response.
</p>
<p>For a more advanced download interface which supports concurrent requests and
resuming large files, have a look at the <a href="#multi_download">multi_download</a> function.
</p>


<h3>Value</h3>

<p>Path of downloaded file (invisibly).
</p>


<h3>See Also</h3>

<p>Advanced download interface: <a href="#multi_download">multi_download</a>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Download large file</span>
<span class="token comment">## Not run: </span>
url <span class="token operator">&lt;-</span> <span class="token string">"http://www2.census.gov/acs2011_5yr/pums/csv_pus.zip"</span>
tmp <span class="token operator">&lt;-</span> tempfile<span class="token punctuation">(</span><span class="token punctuation">)</span>
curl_download<span class="token punctuation">(</span>url<span class="token punctuation">,</span> tmp<span class="token punctuation">)</span>

<span class="token comment">## End(Not run)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="curl_echo">

<a href="#curl_echo" class="help-page-title"><h2 id="curl_echo">Echo Service</h2></a>

<h3>Description</h3>

<p>This function is only for testing purposes. It starts a local httpuv server to
echo the request body and content type in the response.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">curl_echo<span class="token punctuation">(</span>handle<span class="token punctuation">,</span> port <span class="token operator">=</span> <span class="token number">9359</span><span class="token punctuation">,</span> progress <span class="token operator">=</span> interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> file <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="curl_echo_:_handle">handle</code></td>
<td>
<p>a curl handle object</p>
</td>
</tr>
<tr>
<td><code id="curl_echo_:_port">port</code></td>
<td>
<p>the port number on which to run httpuv server</p>
</td>
</tr>
<tr>
<td><code id="curl_echo_:_progress">progress</code></td>
<td>
<p>show progress meter during http transfer</p>
</td>
</tr>
<tr>
<td><code id="curl_echo_:_file">file</code></td>
<td>
<p>path or connection to write body. Default returns body as raw vector.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token keyword">if</span><span class="token punctuation">(</span>require<span class="token punctuation">(</span><span class="token string">'httpuv'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
h <span class="token operator">&lt;-</span> new_handle<span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">'https://httpbin.org/post'</span><span class="token punctuation">)</span>
handle_setform<span class="token punctuation">(</span>h<span class="token punctuation">,</span> foo <span class="token operator">=</span> <span class="token string">"blabla"</span><span class="token punctuation">,</span> bar <span class="token operator">=</span> charToRaw<span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  myfile <span class="token operator">=</span> form_file<span class="token punctuation">(</span>system.file<span class="token punctuation">(</span><span class="token string">"DESCRIPTION"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"text/description"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Echo the POST request data</span>
formdata <span class="token operator">&lt;-</span> curl_echo<span class="token punctuation">(</span>h<span class="token punctuation">)</span>

<span class="token comment"># Show the multipart body</span>
cat<span class="token punctuation">(</span>rawToChar<span class="token punctuation">(</span>formdata<span class="token operator">$</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Parse multipart</span>
webutils<span class="token operator">::</span>parse_http<span class="token punctuation">(</span>formdata<span class="token operator">$</span>body<span class="token punctuation">,</span> formdata<span class="token operator">$</span>content_type<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="curl_escape">

<a href="#curl_escape" class="help-page-title"><h2 id="curl_escape">URL encoding</h2></a>

<h3>Description</h3>

<p>Escape all special characters (i.e. everything except for a-z, A-Z, 0-9, '-',
'.', '_' or '~') for use in URLs.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">curl_escape<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

curl_unescape<span class="token punctuation">(</span>url<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="curl_escape_:_url">url</code></td>
<td>
<p>A character vector (typically containing urls or parameters) to be
encoded/decoded</p>
</td>
</tr></table>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Escape strings</span>
out <span class="token operator">&lt;-</span> curl_escape<span class="token punctuation">(</span><span class="token string">"foo = bar + 5"</span><span class="token punctuation">)</span>
curl_unescape<span class="token punctuation">(</span>out<span class="token punctuation">)</span>

<span class="token comment"># All non-ascii characters are encoded</span>
mu <span class="token operator">&lt;-</span> <span class="token string">"\u00b5"</span>
curl_escape<span class="token punctuation">(</span>mu<span class="token punctuation">)</span>
curl_unescape<span class="token punctuation">(</span>curl_escape<span class="token punctuation">(</span>mu<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="curl_fetch">

<a href="#curl_fetch" class="help-page-title"><h2 id="curl_fetch_memory">Fetch the contents of a URL</h2></a>

<h3>Description</h3>

<p>Low-level bindings to write data from a URL into memory, disk or a callback
function. These are mainly intended for <code>httr</code>, most users will be better
off using the <code><a href="#curl">curl</a></code> or <code><a href="#curl_download">curl_download</a></code> function, or the
http specific wrappers in the <code>httr</code> package.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">curl_fetch_memory<span class="token punctuation">(</span>url<span class="token punctuation">,</span> handle <span class="token operator">=</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

curl_fetch_disk<span class="token punctuation">(</span>url<span class="token punctuation">,</span> path<span class="token punctuation">,</span> handle <span class="token operator">=</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

curl_fetch_stream<span class="token punctuation">(</span>url<span class="token punctuation">,</span> fun<span class="token punctuation">,</span> handle <span class="token operator">=</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

curl_fetch_multi<span class="token punctuation">(</span>
  url<span class="token punctuation">,</span>
  done <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  fail <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  pool <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  handle <span class="token operator">=</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

curl_fetch_echo<span class="token punctuation">(</span>url<span class="token punctuation">,</span> handle <span class="token operator">=</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="curl_fetch_memory_:_url">url</code></td>
<td>
<p>A character string naming the URL of a resource to be downloaded.</p>
</td>
</tr>
<tr>
<td><code id="curl_fetch_memory_:_handle">handle</code></td>
<td>
<p>a curl handle object</p>
</td>
</tr>
<tr>
<td><code id="curl_fetch_memory_:_path">path</code></td>
<td>
<p>Path to save results</p>
</td>
</tr>
<tr>
<td><code id="curl_fetch_memory_:_fun">fun</code></td>
<td>
<p>Callback function. Should have one argument, which will be
a raw vector.</p>
</td>
</tr>
<tr>
<td><code id="curl_fetch_memory_:_done">done</code></td>
<td>
<p>callback function for completed request. Single argument with
response data in same structure as <a href="#curl_fetch">curl_fetch_memory</a>.</p>
</td>
</tr>
<tr>
<td><code id="curl_fetch_memory_:_fail">fail</code></td>
<td>
<p>callback function called on failed request. Argument contains
error message.</p>
</td>
</tr>
<tr>
<td><code id="curl_fetch_memory_:_pool">pool</code></td>
<td>
<p>a multi handle created by <a href="#multi">new_pool</a>. Default uses a global pool.</p>
</td>
</tr>
<tr>
<td><code id="curl_fetch_memory_:_data">data</code></td>
<td>
<p>(advanced) callback function, file path, or connection object for writing
incoming data. This callback should only be used for <em>streaming</em> applications,
where small pieces of incoming data get written before the request has completed. The
signature for the callback function is <code>write(data, final = FALSE)</code>. If set
to <code>NULL</code> the entire response gets buffered internally and returned by in
the <code>done</code> callback (which is usually what you want).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The curl_fetch functions automatically raise an error upon protocol problems
(network, disk, ssl) but do not implement application logic. For example for
you need to check the status code of http requests yourself in the response,
and deal with it accordingly.
</p>
<p>Both <code>curl_fetch_memory</code> and <code>curl_fetch_disk</code> have a blocking and
non-blocking C implementation. The latter is slightly slower but allows for
interrupting the download prematurely (using e.g. CTRL+C or ESC). Interrupting
is enabled when R runs in interactive mode or when
<code>getOption("curl_interrupt") == TRUE</code>.
</p>
<p>The <code>curl_fetch_multi</code> function is the asynchronous equivalent of
<code>curl_fetch_memory</code>. It wraps <code>multi_add</code> to schedule requests which
are executed concurrently when calling <code>multi_run</code>. For each successful
request the <code>done</code> callback is triggered with response data. For failed
requests (when <code>curl_fetch_memory</code> would raise an error), the <code>fail</code>
function is triggered with the error message.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Load in memory</span>
res <span class="token operator">&lt;-</span> curl_fetch_memory<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/cookies/set?foo=123&amp;bar=ftw"</span><span class="token punctuation">)</span>
res<span class="token operator">$</span>content

<span class="token comment"># Save to disk</span>
res <span class="token operator">&lt;-</span> curl_fetch_disk<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/stream/10"</span><span class="token punctuation">,</span> tempfile<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
res<span class="token operator">$</span>content
readLines<span class="token punctuation">(</span>res<span class="token operator">$</span>content<span class="token punctuation">)</span>

<span class="token comment"># Stream with callback</span>
res <span class="token operator">&lt;-</span> curl_fetch_stream<span class="token punctuation">(</span><span class="token string">"http://www.httpbin.org/drip?duration=3&amp;numbytes=15&amp;code=200"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">{</span>
  cat<span class="token punctuation">(</span>rawToChar<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># Async API</span>
data <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>
success <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{</span>
  cat<span class="token punctuation">(</span><span class="token string">"Request done! Status:"</span><span class="token punctuation">,</span> res<span class="token operator">$</span>status<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
  data <span class="token operator">&lt;&lt;-</span> c<span class="token punctuation">(</span>data<span class="token punctuation">,</span> list<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
failure <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
  cat<span class="token punctuation">(</span><span class="token string">"Oh noes! Request failed!"</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
curl_fetch_multi<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/get"</span><span class="token punctuation">,</span> success<span class="token punctuation">,</span> failure<span class="token punctuation">)</span>
curl_fetch_multi<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/status/418"</span><span class="token punctuation">,</span> success<span class="token punctuation">,</span> failure<span class="token punctuation">)</span>
curl_fetch_multi<span class="token punctuation">(</span><span class="token string">"https://urldoesnotexist.xyz"</span><span class="token punctuation">,</span> success<span class="token punctuation">,</span> failure<span class="token punctuation">)</span>
multi_run<span class="token punctuation">(</span><span class="token punctuation">)</span>
str<span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="curl_options">

<a href="#curl_options" class="help-page-title"><h2 id="curl_options">List curl version and options.</h2></a>

<h3>Description</h3>

<p><code>curl_version()</code> shows the versions of libcurl, libssl and zlib and
supported protocols. <code>curl_options()</code> lists all options available in
the current version of libcurl.  The dataset <code>curl_symbols</code> lists all
symbols (including options) provides more information about the symbols,
including when support was added/removed from libcurl.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">curl_options<span class="token punctuation">(</span>filter <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>

curl_symbols<span class="token punctuation">(</span>filter <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span>

curl_version<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="curl_options_:_filter">filter</code></td>
<td>
<p>string: only return options with string in name</p>
</td>
</tr></table>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Available options</span>
curl_options<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># List proxy options</span>
curl_options<span class="token punctuation">(</span><span class="token string">"proxy"</span><span class="token punctuation">)</span>

<span class="token comment"># Symbol table</span>
curl_symbols<span class="token punctuation">(</span><span class="token string">"proxy"</span><span class="token punctuation">)</span>
<span class="token comment"># Curl/ssl version info</span>
curl_version<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="curl_upload">

<a href="#curl_upload" class="help-page-title"><h2 id="curl_upload">Upload a File</h2></a>

<h3>Description</h3>

<p>Upload a file to an <code>http://</code>, <code>ftp://</code>, or <code>sftp://</code> (ssh)
server. Uploading to HTTP means performing an <code>HTTP PUT</code> on that URL.
Be aware that sftp is only available for libcurl clients built with libssh2.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">curl_upload<span class="token punctuation">(</span>file<span class="token punctuation">,</span> url<span class="token punctuation">,</span> verbose <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> reuse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="curl_upload_:_file">file</code></td>
<td>
<p>connection object or path to an existing file on disk</p>
</td>
</tr>
<tr>
<td><code id="curl_upload_:_url">url</code></td>
<td>
<p>where to upload, should start with e.g. <code>ftp://</code></p>
</td>
</tr>
<tr>
<td><code id="curl_upload_:_verbose">verbose</code></td>
<td>
<p>emit some progress output</p>
</td>
</tr>
<tr>
<td><code id="curl_upload_:_reuse">reuse</code></td>
<td>
<p>try to keep alive and recycle connections when possible</p>
</td>
</tr>
<tr>
<td><code id="curl_upload_:_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="#handle">handle_setopt</a></code>, for
example a <code>username</code> and <code>password</code>.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Not run: # Upload package to winbuilder:</span>
curl_upload<span class="token punctuation">(</span><span class="token string">'mypkg_1.3.tar.gz'</span><span class="token punctuation">,</span> <span class="token string">'ftp://win-builder.r-project.org/R-devel/'</span><span class="token punctuation">)</span>

<span class="token comment">## End(Not run)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="file_writer">

<a href="#file_writer" class="help-page-title"><h2 id="file_writer">Lazy File Writer</h2></a>

<h3>Description</h3>

<p>Generates a closure that writes binary (raw) data to a file.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">file_writer<span class="token punctuation">(</span>path<span class="token punctuation">,</span> append <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="file_writer_:_path">path</code></td>
<td>
<p>file name or path on disk</p>
</td>
</tr>
<tr>
<td><code id="file_writer_:_append">append</code></td>
<td>
<p>open file in append mode</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The writer function automatically opens the file on the first write and closes when
it goes out of scope, or explicitly by setting <code>close = TRUE</code>. This can be used
for the <code>data</code> callback in <code>multi_add()</code> or <code>curl_fetch_multi()</code> such
that we only keep open file handles for active downloads. This prevents running out
of file descriptors when performing thousands of concurrent requests.
</p>


<h3>Value</h3>

<p>Function with signature <code>writer(data = raw(), close = FALSE)</code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Doesn't open yet</span>
tmp <span class="token operator">&lt;-</span> tempfile<span class="token punctuation">(</span><span class="token punctuation">)</span>
writer <span class="token operator">&lt;-</span> file_writer<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>

<span class="token comment"># Now it opens</span>
writer<span class="token punctuation">(</span>charToRaw<span class="token punctuation">(</span><span class="token string">"Hello!\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
writer<span class="token punctuation">(</span>charToRaw<span class="token punctuation">(</span><span class="token string">"How are you?\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Close it!</span>
writer<span class="token punctuation">(</span>charToRaw<span class="token punctuation">(</span><span class="token string">"All done!\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> close <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment"># Check it worked</span>
readLines<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="handle">

<a href="#handle" class="help-page-title"><h2 id="handle">Create and configure a curl handle</h2></a>

<h3>Description</h3>

<p>Handles are the work horses of libcurl. A handle is used to configure a
request with custom options, headers and payload. Once the handle has been
set up, it can be passed to any of the download functions such as <code><a href="#curl">curl</a></code>
,<code><a href="#curl_download">curl_download</a></code> or <code><a href="#curl_fetch">curl_fetch_memory</a></code>. The handle will maintain
state in between requests, including keep-alive connections, cookies and
settings.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">new_handle<span class="token punctuation">(</span><span class="token ellipsis">...</span><span class="token punctuation">)</span>

handle_setopt<span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> .list <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

handle_setheaders<span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> .list <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

handle_getheaders<span class="token punctuation">(</span>handle<span class="token punctuation">)</span>

handle_getcustom<span class="token punctuation">(</span>handle<span class="token punctuation">)</span>

handle_setform<span class="token punctuation">(</span>handle<span class="token punctuation">,</span> <span class="token ellipsis">...</span><span class="token punctuation">,</span> .list <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

handle_reset<span class="token punctuation">(</span>handle<span class="token punctuation">)</span>

handle_data<span class="token punctuation">(</span>handle<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="handle_:_...">...</code></td>
<td>
<p>named options / headers to be set in the handle.
To send a file, see <code><a href="#multipart">form_file</a></code>. To list all allowed options,
see <code><a href="#curl_options">curl_options</a></code></p>
</td>
</tr>
<tr>
<td><code id="handle_:_handle">handle</code></td>
<td>
<p>Handle to modify</p>
</td>
</tr>
<tr>
<td><code id="handle_:_.list">.list</code></td>
<td>
<p>A named list of options. This is useful if you've created
a list of options elsewhere, avoiding the use of <code>do.call()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Use <code>new_handle()</code> to create a new clean curl handle that can be
configured with custom options and headers. Note that <code>handle_setopt</code>
appends or overrides options in the handle, whereas <code>handle_setheaders</code>
replaces the entire set of headers with the new ones. The <code>handle_reset</code>
function resets only options/headers/forms in the handle. It does not affect
active connections, cookies or response data from previous requests. The safest
way to perform multiple independent requests is by using a separate handle for
each request. There is very little performance overhead in creating handles.
</p>


<h3>Value</h3>

<p>A handle object (external pointer to the underlying curl handle).
All functions modify the handle in place but also return the handle
so you can create a pipeline of operations.
</p>


<h3>See Also</h3>

<p>Other handles: 
<code><a href="#handle_cookies">handle_cookies</a>()</code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">h <span class="token operator">&lt;-</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span>
handle_setopt<span class="token punctuation">(</span>h<span class="token punctuation">,</span> customrequest <span class="token operator">=</span> <span class="token string">"PUT"</span><span class="token punctuation">)</span>
handle_setform<span class="token punctuation">(</span>h<span class="token punctuation">,</span> a <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token string">"2"</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> curl_fetch_memory<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/put"</span><span class="token punctuation">,</span> h<span class="token punctuation">)</span>
cat<span class="token punctuation">(</span>rawToChar<span class="token punctuation">(</span>r<span class="token operator">$</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Or use the list form</span>
h <span class="token operator">&lt;-</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span>
handle_setopt<span class="token punctuation">(</span>h<span class="token punctuation">,</span> .list <span class="token operator">=</span> list<span class="token punctuation">(</span>customrequest <span class="token operator">=</span> <span class="token string">"PUT"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
handle_setform<span class="token punctuation">(</span>h<span class="token punctuation">,</span> .list <span class="token operator">=</span> list<span class="token punctuation">(</span>a <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
r <span class="token operator">&lt;-</span> curl_fetch_memory<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/put"</span><span class="token punctuation">,</span> h<span class="token punctuation">)</span>
cat<span class="token punctuation">(</span>rawToChar<span class="token punctuation">(</span>r<span class="token operator">$</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="handle_cookies">

<a href="#handle_cookies" class="help-page-title"><h2 id="handle_cookies">Extract cookies from a handle</h2></a>

<h3>Description</h3>

<p>The <code>handle_cookies</code> function returns a data frame with 7 columns as specified in the
<a href="http://www.cookiecentral.com/faq/#3.5" target="_blank">netscape cookie file format</a>.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">handle_cookies<span class="token punctuation">(</span>handle<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="handle_cookies_:_handle">handle</code></td>
<td>
<p>a curl handle object</p>
</td>
</tr></table>
<h3>See Also</h3>

<p>Other handles: 
<code><a href="#handle">handle</a></code>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">h <span class="token operator">&lt;-</span> new_handle<span class="token punctuation">(</span><span class="token punctuation">)</span>
handle_cookies<span class="token punctuation">(</span>h<span class="token punctuation">)</span>

<span class="token comment"># Server sets cookies</span>
req <span class="token operator">&lt;-</span> curl_fetch_memory<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/cookies/set?foo=123&amp;bar=ftw"</span><span class="token punctuation">,</span> handle <span class="token operator">=</span> h<span class="token punctuation">)</span>
handle_cookies<span class="token punctuation">(</span>h<span class="token punctuation">)</span>

<span class="token comment"># Server deletes cookies</span>
req <span class="token operator">&lt;-</span> curl_fetch_memory<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/cookies/delete?foo"</span><span class="token punctuation">,</span> handle <span class="token operator">=</span> h<span class="token punctuation">)</span>
handle_cookies<span class="token punctuation">(</span>h<span class="token punctuation">)</span>

<span class="token comment"># Cookies will survive a reset!</span>
handle_reset<span class="token punctuation">(</span>h<span class="token punctuation">)</span>
handle_cookies<span class="token punctuation">(</span>h<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="ie_proxy">

<a href="#ie_proxy" class="help-page-title"><h2 id="ie_proxy">Internet Explorer proxy settings</h2></a>

<h3>Description</h3>

<p>Lookup and mimic the system proxy settings on Windows as set by Internet
Explorer. This can be used to configure curl to use the same proxy server.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">ie_proxy_info<span class="token punctuation">(</span><span class="token punctuation">)</span>

ie_get_proxy_for_url<span class="token punctuation">(</span>target_url <span class="token operator">=</span> <span class="token string">"http://www.google.com"</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="ie_proxy_:_target_url">target_url</code></td>
<td>
<p>url with host for which to lookup the proxy server</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The <a href="#ie_proxy">ie_proxy_info</a> function looks up your current proxy settings as configured
in IE under "Internet Options" under "LAN Settings". The <a href="#ie_proxy">ie_get_proxy_for_url</a>
determines if and which proxy should be used to connect to a particular
URL. If your settings have an "automatic configuration script" this
involves downloading and executing a PAC file, which can take a while.
</p>

<hr>
</div>
<div class="container manual-page" id="multi">

<a href="#multi" class="help-page-title"><h2 id="multi">Async Concurrent Requests</h2></a>

<h3>Description</h3>

<p>AJAX style concurrent requests, possibly using HTTP/2 multiplexing.
Results are only available via callback functions. Advanced use only!
For downloading many files in parallel use <a href="#multi_download">multi_download</a> instead.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">multi_add<span class="token punctuation">(</span>handle<span class="token punctuation">,</span> done <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> fail <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> pool <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>

multi_run<span class="token punctuation">(</span>timeout <span class="token operator">=</span> <span class="token number">Inf</span><span class="token punctuation">,</span> poll <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> pool <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>

multi_set<span class="token punctuation">(</span>total_con <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> host_con <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> multiplex <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span> pool <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>

multi_list<span class="token punctuation">(</span>pool <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>

multi_cancel<span class="token punctuation">(</span>handle<span class="token punctuation">)</span>

new_pool<span class="token punctuation">(</span>total_con <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> host_con <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> multiplex <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

multi_fdset<span class="token punctuation">(</span>pool <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="multi_:_handle">handle</code></td>
<td>
<p>a curl <a href="#handle">handle</a> with preconfigured <code>url</code> option.</p>
</td>
</tr>
<tr>
<td><code id="multi_:_done">done</code></td>
<td>
<p>callback function for completed request. Single argument with
response data in same structure as <a href="#curl_fetch">curl_fetch_memory</a>.</p>
</td>
</tr>
<tr>
<td><code id="multi_:_fail">fail</code></td>
<td>
<p>callback function called on failed request. Argument contains
error message.</p>
</td>
</tr>
<tr>
<td><code id="multi_:_data">data</code></td>
<td>
<p>(advanced) callback function, file path, or connection object for writing
incoming data. This callback should only be used for <em>streaming</em> applications,
where small pieces of incoming data get written before the request has completed. The
signature for the callback function is <code>write(data, final = FALSE)</code>. If set
to <code>NULL</code> the entire response gets buffered internally and returned by in
the <code>done</code> callback (which is usually what you want).</p>
</td>
</tr>
<tr>
<td><code id="multi_:_pool">pool</code></td>
<td>
<p>a multi handle created by <a href="#multi">new_pool</a>. Default uses a global pool.</p>
</td>
</tr>
<tr>
<td><code id="multi_:_timeout">timeout</code></td>
<td>
<p>max time in seconds to wait for results. Use <code>0</code> to poll for results without
waiting at all.</p>
</td>
</tr>
<tr>
<td><code id="multi_:_poll">poll</code></td>
<td>
<p>If <code>TRUE</code> then return immediately after any of the requests has completed.
May also be an integer in which case it returns after n requests have completed.</p>
</td>
</tr>
<tr>
<td><code id="multi_:_total_con">total_con</code></td>
<td>
<p>max total concurrent connections.</p>
</td>
</tr>
<tr>
<td><code id="multi_:_host_con">host_con</code></td>
<td>
<p>max concurrent connections per host.</p>
</td>
</tr>
<tr>
<td><code id="multi_:_multiplex">multiplex</code></td>
<td>
<p>enable HTTP/2 multiplexing if supported by host and client.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Requests are created in the usual way using a curl <a href="#handle">handle</a> and added
to the scheduler with <a href="#multi">multi_add</a>. This function returns immediately
and does not perform the request yet. The user needs to call <a href="#multi">multi_run</a>
which performs all scheduled requests concurrently. It returns when all
requests have completed, or case of a <code>timeout</code> or <code>SIGINT</code> (e.g.
if the user presses <code>ESC</code> or <code>CTRL+C</code> in the console). In case of
the latter, simply call <a href="#multi">multi_run</a> again to resume pending requests.
</p>
<p>When the request succeeded, the <code>done</code> callback gets triggered with
the response data. The structure if this data is identical to <a href="#curl_fetch">curl_fetch_memory</a>.
When the request fails, the <code>fail</code> callback is triggered with an error
message. Note that failure here means something went wrong in performing the
request such as a connection failure, it does not check the http status code.
Just like <a href="#curl_fetch">curl_fetch_memory</a>, the user has to implement application logic.
</p>
<p>Raising an error within a callback function stops execution of that function
but does not affect other requests.
</p>
<p>A single handle cannot be used for multiple simultaneous requests. However
it is possible to add new requests to a pool while it is running, so you
can re-use a handle within the callback of a request from that same handle.
It is up to the user to make sure the same handle is not used in concurrent
requests.
</p>
<p>The <a href="#multi">multi_cancel</a> function can be used to cancel a pending request.
It has no effect if the request was already completed or canceled.
</p>
<p>The <a href="#multi">multi_fdset</a> function returns the file descriptors curl is
polling currently, and also a timeout parameter, the number of
milliseconds an application should wait (at most) before proceeding. It
is equivalent to the <code>curl_multi_fdset</code> and
<code>curl_multi_timeout</code> calls. It is handy for applications that is
expecting input (or writing output) through both curl, and other file
descriptors.
</p>


<h3>See Also</h3>

<p>Advanced download interface: <a href="#multi_download">multi_download</a>
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">results <span class="token operator">&lt;-</span> list<span class="token punctuation">(</span><span class="token punctuation">)</span>
success <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">{</span>
  results <span class="token operator">&lt;&lt;-</span> append<span class="token punctuation">(</span>results<span class="token punctuation">,</span> list<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
failure <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">{</span>
  cat<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">"Failed request:"</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">,</span> file <span class="token operator">=</span> stderr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment"># This handle will take longest (3sec)</span>
h1 <span class="token operator">&lt;-</span> new_handle<span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">"https://eu.httpbin.org/delay/3"</span><span class="token punctuation">)</span>
multi_add<span class="token punctuation">(</span>h1<span class="token punctuation">,</span> done <span class="token operator">=</span> success<span class="token punctuation">,</span> fail <span class="token operator">=</span> failure<span class="token punctuation">)</span>

<span class="token comment"># This handle writes data to a file</span>
con <span class="token operator">&lt;-</span> file<span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">)</span>
h2 <span class="token operator">&lt;-</span> new_handle<span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">"https://eu.httpbin.org/post"</span><span class="token punctuation">,</span> postfields <span class="token operator">=</span> <span class="token string">"bla bla"</span><span class="token punctuation">)</span>
multi_add<span class="token punctuation">(</span>h2<span class="token punctuation">,</span> done <span class="token operator">=</span> success<span class="token punctuation">,</span> fail <span class="token operator">=</span> failure<span class="token punctuation">,</span> data <span class="token operator">=</span> con<span class="token punctuation">)</span>

<span class="token comment"># This handle raises an error</span>
h3 <span class="token operator">&lt;-</span> new_handle<span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">"https://urldoesnotexist.xyz"</span><span class="token punctuation">)</span>
multi_add<span class="token punctuation">(</span>h3<span class="token punctuation">,</span> done <span class="token operator">=</span> success<span class="token punctuation">,</span> fail <span class="token operator">=</span> failure<span class="token punctuation">)</span>

<span class="token comment"># Actually perform the requests</span>
multi_run<span class="token punctuation">(</span>timeout <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
multi_run<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Check the file</span>
readLines<span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">)</span>
unlink<span class="token punctuation">(</span><span class="token string">"output.txt"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="multi_download">

<a href="#multi_download" class="help-page-title"><h2 id="multi_download">Advanced download interface</h2></a>

<h3>Description</h3>

<p>Download multiple files concurrently, with support for resuming large files.
This function is based on <code><a href="#multi">multi_run()</a></code> and hence does not error in case any
of the individual requests fail; you should inspect the return value to find
out which of the downloads were completed successfully.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">multi_download<span class="token punctuation">(</span>
  urls<span class="token punctuation">,</span>
  destfiles <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span>
  resume <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span>
  progress <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
  timeout <span class="token operator">=</span> <span class="token number">Inf</span><span class="token punctuation">,</span>
  <span class="token ellipsis">...</span>
<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="multi_download_:_urls">urls</code></td>
<td>
<p>vector with files to download</p>
</td>
</tr>
<tr>
<td><code id="multi_download_:_destfiles">destfiles</code></td>
<td>
<p>vector (of equal length as <code>urls</code>) with paths of output files,
or <code>NULL</code> to use <a href="https://r-universe.dev/manuals/base.html#basename">basename</a> of urls.</p>
</td>
</tr>
<tr>
<td><code id="multi_download_:_resume">resume</code></td>
<td>
<p>if the file already exists, resume the download. Note that this may
change server responses, see details.</p>
</td>
</tr>
<tr>
<td><code id="multi_download_:_progress">progress</code></td>
<td>
<p>print download progress information</p>
</td>
</tr>
<tr>
<td><code id="multi_download_:_timeout">timeout</code></td>
<td>
<p>in seconds, passed to <a href="#multi">multi_run</a></p>
</td>
</tr>
<tr>
<td><code id="multi_download_:_...">...</code></td>
<td>
<p>extra handle options passed to each request <a href="#handle">new_handle</a></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Upon completion of all requests, this function returns a data frame with results.
The <code>success</code> column indicates if a request was successfully completed (regardless
of the HTTP status code). If it failed, e.g. due to a networking issue, the error
message is in the <code>error</code> column. A <code>success</code> value <code>NA</code> indicates that the request
was still in progress when the function was interrupted or reached the elapsed
<code>timeout</code> and perhaps the download can be resumed if the server supports it.
</p>
<p>It is also important to inspect the <code>status_code</code> column to see if any of the
requests were successful but had a non-success HTTP code, and hence the downloaded
file probably contains an error page instead of the requested content.
</p>
<p>Note that when you set <code>resume = TRUE</code> you should expect HTTP-206 or HTTP-416
responses. The latter could indicate that the file was already complete, hence
there was no content left to resume from the server. If you try to resume a file
download but the server does not support this, success if <code>FALSE</code> and the file
will not be touched. In fact, if we request to a download to be resumed and the
server responds <code style="white-space: pre;">⁠HTTP 200⁠</code> instead of <code style="white-space: pre;">⁠HTTP 206⁠</code>, libcurl will error and not
download anything, because this probably means the server did not respect our
range request and is sending us the full file.
</p>


<h4>About HTTP/2</h4>

<p>Availability of HTTP/2 can increase the performance when making many parallel
requests to a server, because HTTP/2 can multiplex many requests over a single
TCP connection. Support for HTTP/2 depends on the version of <code>libcurl</code> that
your system has, and the TLS back-end that is in use, check <a href="#curl_options">curl_version</a>.
For clients or servers without HTTP/2, curl makes at most 6 connections per
host over which it distributes the queued downloads.
</p>
<p>On Windows and MacOS you can switch the active TLS backend by setting an
environment variable <a href="https://curl.se/libcurl/c/libcurl-env.html" target="_blank"><code>CURL_SSL_BACKEND</code></a>
in your <code style="white-space: pre;">⁠~/.Renviron⁠</code> file. On Windows you can switch between <code>SecureChannel</code>
(default) and <code>OpenSSL</code> where only the latter supports HTTP/2. On MacOS you
can use either <code>SecureTransport</code> or <code>LibreSSL</code>, the default varies by MacOS
version.
</p>



<h3>Value</h3>

<p>The function returns a data frame with one row for each downloaded file and
the following columns:
</p>

<ul>
<li> <p><code>success</code> if the HTTP request was successfully performed, regardless of the
response status code. This is <code>FALSE</code> in case of a network error, or in case
you tried to resume from a server that did not support this. A value of <code>NA</code>
means the download was interrupted while in progress.
</p>
</li>
<li> <p><code>status_code</code> the HTTP status code from the request. A successful download is
usually <code>200</code> for full requests or <code>206</code> for resumed requests. Anything else
could indicate that the downloaded file contains an error page instead of the
requested content.
</p>
</li>
<li> <p><code>resumefrom</code> the file size before the request, in case a download was resumed.
</p>
</li>
<li> <p><code>url</code> final url (after redirects) of the request.
</p>
</li>
<li> <p><code>destfile</code> downloaded file on disk.
</p>
</li>
<li> <p><code>error</code> if <code>success == FALSE</code> this column contains an error message.
</p>
</li>
<li> <p><code>type</code> the <code>Content-Type</code> response header value.
</p>
</li>
<li> <p><code>modified</code> the <code>Last-Modified</code> response header value.
</p>
</li>
<li> <p><code>time</code> total elapsed download time for this file in seconds.
</p>
</li>
<li> <p><code>headers</code> vector with http response headers for the request.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Not run: </span>
<span class="token comment"># Example: some large files</span>
urls <span class="token operator">&lt;-</span> sprintf<span class="token punctuation">(</span>
  <span class="token string">"https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2021-%02d.parquet"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>
res <span class="token operator">&lt;-</span> multi_download<span class="token punctuation">(</span>urls<span class="token punctuation">,</span> resume <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span> <span class="token comment"># You can interrupt (ESC) and resume</span>

<span class="token comment"># Example: revdep checker</span>
<span class="token comment"># Download all reverse dependencies for the 'curl' package from CRAN:</span>
pkg <span class="token operator">&lt;-</span> <span class="token string">'curl'</span>
mirror <span class="token operator">&lt;-</span> <span class="token string">'https://cloud.r-project.org'</span>
db <span class="token operator">&lt;-</span> available.packages<span class="token punctuation">(</span>repos <span class="token operator">=</span> mirror<span class="token punctuation">)</span>
packages <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>pkg<span class="token punctuation">,</span> tools<span class="token operator">::</span>package_dependencies<span class="token punctuation">(</span>pkg<span class="token punctuation">,</span> db <span class="token operator">=</span> db<span class="token punctuation">,</span> reverse <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span>pkg<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
versions <span class="token operator">&lt;-</span> db<span class="token punctuation">[</span>packages<span class="token punctuation">,</span><span class="token string">'Version'</span><span class="token punctuation">]</span>
urls <span class="token operator">&lt;-</span> sprintf<span class="token punctuation">(</span><span class="token string">"%s/src/contrib/%s_%s.tar.gz"</span><span class="token punctuation">,</span> mirror<span class="token punctuation">,</span> packages<span class="token punctuation">,</span>  versions<span class="token punctuation">)</span>
res <span class="token operator">&lt;-</span> multi_download<span class="token punctuation">(</span>urls<span class="token punctuation">)</span>
all.equal<span class="token punctuation">(</span>unname<span class="token punctuation">(</span>tools<span class="token operator">::</span>md5sum<span class="token punctuation">(</span>res<span class="token operator">$</span>destfile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> unname<span class="token punctuation">(</span>db<span class="token punctuation">[</span>packages<span class="token punctuation">,</span> <span class="token string">'MD5sum'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># And then you could use e.g.: tools:::check_packages_in_dir()</span>

<span class="token comment"># Example: URL checker</span>
pkg_url_checker <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">{</span>
  db <span class="token operator">&lt;-</span> tools<span class="token operator">::</span><span class="token operator">:</span>url_db_from_package_sources<span class="token punctuation">(</span>dir<span class="token punctuation">)</span>
  res <span class="token operator">&lt;-</span> multi_download<span class="token punctuation">(</span>db<span class="token operator">$</span>URL<span class="token punctuation">,</span> rep<span class="token punctuation">(</span><span class="token string">'/dev/null'</span><span class="token punctuation">,</span> nrow<span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nobody<span class="token operator">=</span><span class="token boolean">TRUE</span><span class="token punctuation">)</span>
  db<span class="token operator">$</span>OK <span class="token operator">&lt;-</span> res<span class="token operator">$</span>status_code <span class="token operator">==</span> <span class="token number">200</span>
  db
<span class="token punctuation">}</span>

<span class="token comment"># Use a local package source directory</span>
pkg_url_checker<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span>


<span class="token comment">## End(Not run)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="multipart">

<a href="#multipart" class="help-page-title"><h2 id="multipart">POST files or data</h2></a>

<h3>Description</h3>

<p>Build multipart form data elements. The <code>form_file</code> function uploads a
file. The <code>form_data</code> function allows for posting a string or raw vector
with a custom content-type.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">form_file<span class="token punctuation">(</span>path<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>

form_data<span class="token punctuation">(</span>value<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="multipart_:_path">path</code></td>
<td>
<p>a string with a path to an existing file on disk</p>
</td>
</tr>
<tr>
<td><code id="multipart_:_type">type</code></td>
<td>
<p>MIME content-type of the file.</p>
</td>
</tr>
<tr>
<td><code id="multipart_:_name">name</code></td>
<td>
<p>a string with the file name to use for the upload</p>
</td>
</tr>
<tr>
<td><code id="multipart_:_value">value</code></td>
<td>
<p>a character or raw vector to post</p>
</td>
</tr>
</table>
<hr>
</div>
<div class="container manual-page" id="nslookup">

<a href="#nslookup" class="help-page-title"><h2 id="nslookup">Lookup a hostname</h2></a>

<h3>Description</h3>

<p>The <code>nslookup</code> function is similar to <code>nsl</code> but works on all platforms
and can resolve ipv6 addresses if supported by the OS. Default behavior raises an
error if lookup fails.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">nslookup<span class="token punctuation">(</span>host<span class="token punctuation">,</span> ipv4_only <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> multiple <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> error <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

has_internet<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="nslookup_:_host">host</code></td>
<td>
<p>a string with a hostname</p>
</td>
</tr>
<tr>
<td><code id="nslookup_:_ipv4_only">ipv4_only</code></td>
<td>
<p>always return ipv4 address. Set to <code>FALSE</code> to allow for ipv6 as well.</p>
</td>
</tr>
<tr>
<td><code id="nslookup_:_multiple">multiple</code></td>
<td>
<p>returns multiple ip addresses if possible</p>
</td>
</tr>
<tr>
<td><code id="nslookup_:_error">error</code></td>
<td>
<p>raise an error for failed DNS lookup. Otherwise returns <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>has_internet</code> function tests for internet connectivity by performing a
dns lookup. If a proxy server is detected, it will also check for connectivity by
connecting via the proxy.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Should always work if we are online</span>
nslookup<span class="token punctuation">(</span><span class="token string">"www.r-project.org"</span><span class="token punctuation">)</span>

<span class="token comment"># If your OS supports IPv6</span>
nslookup<span class="token punctuation">(</span><span class="token string">"ipv6.test-ipv6.com"</span><span class="token punctuation">,</span> ipv4_only <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">,</span> error <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="parse_date">

<a href="#parse_date" class="help-page-title"><h2 id="parse_date">Parse date/time</h2></a>

<h3>Description</h3>

<p>Can be used to parse dates appearing in http response headers such
as <code>Expires</code> or <code>Last-Modified</code>. Automatically recognizes
most common formats. If the format is known, <code><a href="https://r-universe.dev/manuals/base.html#strptime">strptime</a></code>
might be easier.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">parse_date<span class="token punctuation">(</span>datestring<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table><tr>
<td><code id="parse_date_:_datestring">datestring</code></td>
<td>
<p>a string consisting of a timestamp</p>
</td>
</tr></table>
<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment"># Parse dates in many formats</span>
parse_date<span class="token punctuation">(</span><span class="token string">"Sunday, 06-Nov-94 08:49:37 GMT"</span><span class="token punctuation">)</span>
parse_date<span class="token punctuation">(</span><span class="token string">"06 Nov 1994 08:49:37"</span><span class="token punctuation">)</span>
parse_date<span class="token punctuation">(</span><span class="token string">"20040911 +0200"</span><span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="parse_headers">

<a href="#parse_headers" class="help-page-title"><h2 id="parse_headers">Parse response headers</h2></a>

<h3>Description</h3>

<p>Parse response header data as returned by curl_fetch, either as a set of strings
or into a named list.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">parse_headers<span class="token punctuation">(</span>txt<span class="token punctuation">,</span> multiple <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">)</span>

parse_headers_list<span class="token punctuation">(</span>txt<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="parse_headers_:_txt">txt</code></td>
<td>
<p>raw or character vector with the header data</p>
</td>
</tr>
<tr>
<td><code id="parse_headers_:_multiple">multiple</code></td>
<td>
<p>parse multiple sets of headers separated by a blank line. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parse_headers_list function parses the headers into a normalized (lowercase
field names, trimmed whitespace) named list.
</p>
<p>If a request has followed redirects, the data can contain multiple sets of headers.
When multiple = TRUE, the function returns a list with the response headers
for each request. By default it only returns the headers of the final request.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r">req <span class="token operator">&lt;-</span> curl_fetch_memory<span class="token punctuation">(</span><span class="token string">"https://httpbin.org/redirect/3"</span><span class="token punctuation">)</span>
parse_headers<span class="token punctuation">(</span>req<span class="token operator">$</span>headers<span class="token punctuation">)</span>
parse_headers<span class="token punctuation">(</span>req<span class="token operator">$</span>headers<span class="token punctuation">,</span> multiple <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span>

<span class="token comment"># Parse into named list</span>
parse_headers_list<span class="token punctuation">(</span>req<span class="token operator">$</span>headers<span class="token punctuation">)</span></code></pre>

<hr>
</div>
<div class="container manual-page" id="send_mail">

<a href="#send_mail" class="help-page-title"><h2 id="send_mail">Send email</h2></a>

<h3>Description</h3>

<p>Use the curl SMTP client to send an email. The <code>message</code> argument must be
properly formatted <a href="https://www.rfc-editor.org/rfc/rfc2822" target="_blank">RFC2822</a> email message with From/To/Subject headers and CRLF
line breaks.
</p>


<h3>Usage</h3>

<pre class="language-r"><code class="language-r">send_mail<span class="token punctuation">(</span>
  mail_from<span class="token punctuation">,</span>
  mail_rcpt<span class="token punctuation">,</span>
  message<span class="token punctuation">,</span>
  smtp_server <span class="token operator">=</span> <span class="token string">"smtp://localhost"</span><span class="token punctuation">,</span>
  use_ssl <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token string">"try"</span><span class="token punctuation">,</span> <span class="token string">"no"</span><span class="token punctuation">,</span> <span class="token string">"force"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  verbose <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">,</span>
  <span class="token ellipsis">...</span>
<span class="token punctuation">)</span></code></pre>


<h3>Arguments</h3>

<table>
<tr>
<td><code id="send_mail_:_mail_from">mail_from</code></td>
<td>
<p>email address of the sender.</p>
</td>
</tr>
<tr>
<td><code id="send_mail_:_mail_rcpt">mail_rcpt</code></td>
<td>
<p>one or more recipient email addresses. Do not include names,
these go into the <code>message</code> headers.</p>
</td>
</tr>
<tr>
<td><code id="send_mail_:_message">message</code></td>
<td>
<p>either a string or connection with (properly formatted) email
message, including sender/recipient/subject headers. See example.</p>
</td>
</tr>
<tr>
<td><code id="send_mail_:_smtp_server">smtp_server</code></td>
<td>
<p>hostname or address of the SMTP server, or, an
<code>smtp://</code> or <code>smtps://</code> URL. See "Specifying the server, port,
and protocol" below.</p>
</td>
</tr>
<tr>
<td><code id="send_mail_:_use_ssl">use_ssl</code></td>
<td>
<p>Request to upgrade the connection to SSL using the STARTTLS command,
see <a href="https://curl.se/libcurl/c/CURLOPT_USE_SSL.html" target="_blank">CURLOPT_USE_SSL</a>
for details. Default will try to SSL, proceed as normal otherwise.</p>
</td>
</tr>
<tr>
<td><code id="send_mail_:_verbose">verbose</code></td>
<td>
<p>print output</p>
</td>
</tr>
<tr>
<td><code id="send_mail_:_...">...</code></td>
<td>
<p>other options passed to <code><a href="#handle">handle_setopt</a></code>. In most cases
you will need to set a <code>username</code> and <code>password</code> to authenticate
with the SMTP server.</p>
</td>
</tr>
</table>
<h3>Specifying the server, port, and protocol</h3>

<p>The <code>smtp_server</code> argument takes a hostname, or an SMTP URL:
</p>

<ul>
<li> <p><code>mail.example.com</code> - hostname only
</p>
</li>
<li> <p><code>mail.example.com:587</code> - hostname and port
</p>
</li>
<li> <p><code>smtp://mail.example.com</code> - protocol and hostname
</p>
</li>
<li> <p><code>smtp://mail.example.com:587</code> - full SMTP URL
</p>
</li>
<li> <p><code>smtps://mail.example.com:465</code> - full SMTPS URL
</p>
</li>
</ul>
<p>By default, the port will be 25, unless <code>smtps://</code> is specified–then
the default will be 465 instead.
</p>


<h3>Encrypting connections via SMTPS or STARTTLS</h3>

<p>There are two different ways in which SMTP can be encrypted: SMTPS servers
run on a port which only accepts encrypted connections, similar to HTTPS.
Alternatively, a regular insecure smtp connection can be "upgraded" to a
secure TLS connection using the STARTTLS command. It is important to know
which method your server expects.
</p>
<p>If your smtp server listens on port 465, then use a  <code>smtps://hostname:465</code>
URL. The SMTPS protocol <em>guarantees</em> that TLS will be used to protect
all communications from the start.
</p>
<p>If your email server listens on port 25 or 587, use an <code>smtp://</code> URL in
combination with the  <code>use_ssl</code> parameter to control if the connection
should be upgraded with STARTTLS. The default value <code>"try"</code> will
<em>opportunistically</em> try to upgrade to a secure connection if the server
supports it, and proceed as normal otherwise.
</p>


<h3>Examples</h3>

<pre class="language-r"><code class="language-r"><span class="token comment">## Not run: # Set sender and recipients (email addresses only)</span>
recipients <span class="token operator">&lt;-</span> readline<span class="token punctuation">(</span><span class="token string">"Enter your email address to receive test: "</span><span class="token punctuation">)</span>
sender <span class="token operator">&lt;-</span> <span class="token string">'test@noreply.com'</span>

<span class="token comment"># Full email message in RFC2822 format</span>
message <span class="token operator">&lt;-</span> 'From<span class="token operator">:</span> <span class="token string">"R (curl package)"</span> <span class="token operator">&lt;</span>test<span class="token operator">@</span>noreply.com<span class="token operator">&gt;</span>
To<span class="token operator">:</span> <span class="token string">"Roger Recipient"</span> <span class="token operator">&lt;</span>roger<span class="token operator">@</span>noreply.com<span class="token operator">&gt;</span>
Subject<span class="token operator">:</span> Hello R user<span class="token operator">!</span>

Dear R user<span class="token punctuation">,</span>

I am sending this email using curl.'

<span class="token comment"># Send the email</span>
send_mail<span class="token punctuation">(</span>sender<span class="token punctuation">,</span> recipients<span class="token punctuation">,</span> message<span class="token punctuation">,</span> smtp_server <span class="token operator">=</span> <span class="token string">'smtps://smtp.gmail.com'</span><span class="token punctuation">,</span>
  username <span class="token operator">=</span> <span class="token string">'curlpackage'</span><span class="token punctuation">,</span> password  <span class="token operator">=</span> <span class="token string">'qyyjddvphjsrbnlm'</span><span class="token punctuation">)</span>
<span class="token comment">## End(Not run)</span></code></pre>

<hr>
</div>
</div>
    <footer><p>Rendered with postdoc 1.2.1</p></footer>
  </body>
</html>
